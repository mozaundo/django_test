ult"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;var s=n(163),u=a(n(31)),c=n(73),d=n(405),f=n(49),h=n(164);t.reducer=function(e,t){if(!e)return{sheets:[],goTo:{value:"",isAnnouncing:!1},editor:{value:"",isEnabled:!1,id:""},deleter:{sheetId:"",isEnabled:!1},errorInfo:{isEnabled:!1,isDismissable:!1,message:""},contextMenuId:"",platform:"NotMac",mousePosition:void 0};switch(t.type){case(0,s.getType)(u.setPlatform):var n=t.payload.platform;return r(r({},e),{platform:n});case(0,s.getType)(u.addSheet):var o=t.payload,i=o.id,a=o.name,p=o.visibility,m=o.position;if($=e.sheets.find((function(e){return e.id===i})))return e;var b={id:i,name:a,visibility:p,position:m,objects:[],isCollapsed:!0,isActive:!1},g=l(l([],e.sheets,!0),[b],!1);return r(r({},e),{sheets:g});case(0,s.getType)(u.removeSheet):case(0,s.getType)(u.deleteSheet.success):var v=t.payload.id;return-1===(oe=e.sheets.findIndex((function(e){return e.id===v})))?e:(g=l(l([],e.sheets.slice(0,oe),!0),e.sheets.slice(oe+1),!0),r(r({},e),{sheets:g}));case(0,s.getType)(u.openDeleter):var y=t.payload.id;if(e.deleter.isEnabled&&e.deleter.sheetId===y)return e;var x={isEnabled:!0,sheetId:y};return r(r({},e),{deleter:x});case(0,s.getType)(u.closeDeleter):return e.deleter.isEnabled?(x={isEnabled:!1,sheetId:""},r(r({},e),{deleter:x})):e;case(0,s.getType)(u.updateSheetName):var S=t.payload,T=S.id,k=S.name;if(-1===(oe=e.sheets.findIndex((function(e){return e.id===T}))))return e;if((D=e.sheets[oe]).name===k)return e;var C=r(r({},D),{name:k});return g=(0,d.replaceInArray)(e.sheets,C,oe),r(r({},e),{sheets:g});case(0,s.getType)(u.changeSheetVisibility.success):case(0,s.getType)(u.updateSheetVisibility):var E=t.payload,_=E.id;return p=E.visibility,-1===(oe=e.sheets.findIndex((function(e){return e.id===_})))?e:(D=e.sheets[oe]).visibility===p?e:(C=r(r({},D),{visibility:p}),g=(0,d.replaceInArray)(e.sheets,C,oe),r(r({},e),{sheets:g}));case(0,s.getType)(u.updateSheetPosition):var O=t.payload,w=O.id;return m=O.position,-1===(oe=e.sheets.findIndex((function(e){return e.id===w})))?e:(D=e.sheets[oe]).position===m?e:(C=r(r({},D),{position:m}),g=(0,d.replaceInArray)(e.sheets,C,oe),r(r({},e),{sheets:g}));case(0,s.getType)(u.setActiveSheet):var A=t.payload.id;return""===A?e.sheets.every((function(e){return!e.isActive}))?e:r(r({},e),{sheets:e.sheets.map((function(e){return r(r({},e),{isActive:!1})}))}):-1===(oe=e.sheets.findIndex((function(e){return e.id===A})))||e.sheets[oe].isActive?e:(g=e.sheets.map((function(e){return r(r({},e),{isActive:e.id===A,isCollapsed:e.id!==A&&e.isCollapsed})})),r(r({},e),{sheets:g}));case(0,s.getType)(u.toggleSheetExpansion):var I=t.payload.id;if(-1===(oe=e.sheets.findIndex((function(e){return e.id===I}))))return e;var j=r(r({},e.sheets[oe]),{isCollapsed:!e.sheets[oe].isCollapsed});return g=(0,d.replaceInArray)(e.sheets,j,oe),r(r({},e),{sheets:g});case(0,s.getType)(u.addObject):var L=t.payload,M=L.sheetId,P=L.object;if(-1===(se=e.sheets.findIndex((function(e){return e.id===M}))))return e;if((R=e.sheets[se].objects).some((function(e){return e.id===P.id})))return e;var D=e.sheets[se];return C=r(r({},D),{objects:l(l([],D.objects,!0),[P],!1)}),g=(0,d.replaceInArray)(e.sheets,C,se),r(r({},e),{sheets:g});case(0,s.getType)(u.removeObject):case(0,s.getType)(u.deleteObject.success):var N=t.payload,B=N.sheetId,F=N.id;if(-1===(se=e.sheets.findIndex((function(e){return e.id===B}))))return e;if(-1===(ce=(ue=e.sheets[se]).objects.findIndex((function(e){return e.id===F}))))return e;var R=ue.objects,z=l(l([],R.slice(0,ce),!0),R.slice(ce+1),!0),H=r(r({},ue),{objects:z}),V=(0,d.replaceInArray)(e.sheets,H,se);return r(r({},e),{sheets:V});case(0,s.getType)(u.updateObject):var U=t.payload,W=U.sheetId,q=U.object;return-1===(se=e.sheets.findIndex((function(e){return e.id===W})))||-1===(ce=(ue=e.sheets[se]).objects.findIndex((function(e){return e.id===q.id})))?e:(R=ue.objects,(0,f.isObjectEqual)(R[ce],q)?e:(z=(0,d.replaceInArray)(R,q,ce),H=r(r({},ue),{objects:z}),V=(0,d.replaceInArray)(e.sheets,H,se),r(r({},e),{sheets:V})));case(0,s.getType)(u.changeObjectVisibility.success):var G=t.payload,K=G.id,J=G.sheetId,Q=G.isVisible;if(-1===(se=e.sheets.findIndex((function(e){return e.id===J}))))return e;if(-1===(ce=(ue=e.sheets[se]).objects.findIndex((function(e){return e.id===K}))))return e;var $=ue.objects[ce];return(0,f.isShape)($)||(0,f.isChart)($)?$.isVisible===Q?e:(z=(0,d.replaceInArray)(ue.objects,r(r({},$),{isVisible:Q}),ce),H=r(r({},ue),{objects:z}),V=(0,d.replaceInArray)(e.sheets,H,se),r(r({},e),{sheets:V})):e;case(0,s.getType)(u.updateGoToValue):var Z=t.payload.value;if(Z===e.goTo.value)return e;g=e.sheets.map((function(e){if(Z.length>0){var t=!e.objects.some((function(e){return(0,h.isInFilter)(e,Z)}));return r(r({},e),{isCollapsed:t})}return r(r({},e),{isCollapsed:!e.isActive})}));var Y=r(r({},e.goTo),{value:Z});return r(r({},e),{sheets:g,goTo:Y});case(0,s.getType)(u.updateGoToIsAnnouncing):var X=t.payload.isAnnouncing;return X===e.goTo.isAnnouncing?e:(Y=r(r({},e.goTo),{isAnnouncing:X}),r(r({},e),{goTo:Y}));case(0,s.getType)(u.openEditor):if(y=t.payload.id,e.editor.id===y&&e.editor.isEnabled)return e;var ee=(0,f.findSheetOrSheetObject)(e.sheets,y);if(!ee)return e;var te={value:ee.name,isEnabled:!0,id:y};return(0,f.isSheet)(ee)&&(te.maxLength=31),r(r({},e),{editor:te});case(0,s.getType)(u.closeEditor):return e.editor.isEnabled?(te=r(r({},e.editor),{isEnabled:!1}),r(r({},e),{editor:te})):e;case(0,s.getType)(u.setEditorValue):var ne=t.payload.value;return e.editor.value===ne?e:(te=r(r({},e.editor),{value:ne}),r(r({},e),{editor:te}));case(0,s.getType)(u.showEditorError):var re=t.payload.message;return e.editor.isEnabled&&e.editor.errorMessage!==re?(te=r(r({},e.editor),{errorMessage:re}),r(r({},e),{editor:te})):e;case(0,s.getType)(u.renameSheet.success):var oe,ie=t.payload,ae=ie.id,le=ie.name;return-1===(oe=e.sheets.findIndex((function(e){return e.id===ae})))||($=e.sheets[oe]).name===le?e:(g=(0,d.replaceInArray)(e.sheets,r(r({},$),{name:le}),oe),r(r({},e),{sheets:g}));case(0,s.getType)(u.renameObject.success):var se,ue,ce,de=t.payload,fe=de.id,he=de.sheetId,pe=de.name;return-1===(se=e.sheets.findIndex((function(e){return e.id===he})))||(-1===(ce=(ue=e.sheets[se]).objects.findIndex((function(e){return e.id===fe})))||($=ue.objects[ce]).name===pe)?e:(z=(0,d.replaceInArray)(ue.objects,r(r({},$),{name:pe}),ce),H=r(r({},ue),{objects:z}),V=(0,d.replaceInArray)(e.sheets,H,se),r(r({},e),{sheets:V}));case(0,s.getType)(u.setContextMenuId):return y=t.payload.id,e.contextMenuId===y?e:r(r({},e),{contextMenuId:y});case(0,s.getType)(u.setMousePosition):var me=t.payload.mousePosition;return r(r({},e),{mousePosition:me});case(0,s.getType)(u.showError):var be={isEnabled:!0,isDismissable:t.payload.isDismissable,message:t.payload.message};return r(r({},e),{errorInfo:be});case(0,s.getType)(u.dismissError):return(be=e.errorInfo).isEnabled&&be.isDismissable?r(r({},e),{errorInfo:r(r({},be),{isEnabled:!1})}):e;case(0,s.getType)(u.navigate.request):case(0,s.getType)(u.navigate.success):case(0,s.getType)(u.navigate.failure):case(0,s.getType)(u.changeSheetVisibility.request):case(0,s.getType)(u.changeSheetVisibility.failure):case(0,s.getType)(u.changeObjectVisibility.request):case(0,s.getType)(u.changeObjectVisibility.failure):case(0,s.getType)(u.renameSheet.request):case(0,s.getType)(u.renameSheet.failure):case(0,s.getType)(u.renameObject.request):case(0,s.getType)(u.renameObject.failure):case(0,s.getType)(u.deleteSheet.request):case(0,s.getType)(u.deleteSheet.failure):case(0,s.getType)(u.deleteObject.request):case(0,s.getType)(u.deleteObject.failure):return e;default:(0,c.assertNever)(t)}return e}},f