un((function(e){return r(d,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=e.application.getActivePage(),n=t.analyzePage(),[4,e.sync()];case 1:return r.sent(),[2,n.value]}}))}))}))];case 1:return u=p.sent(),n.throwIfCancelled(),l={DataType:a.TranslationDataType.Json,Data:u},u?[4,this.translatorApi.translateNormalContent(e,t,l)]:[3,3];case 2:return f=p.sent(),[3,4];case 3:f=null,p.label=4;case 4:if(c=f,n.throwIfCancelled(),!c||!c.TranslatedText)throw new Error(i.GeneralTranslationErrorResponse.message);return null!==s&&s(),n.throwIfCancelled(),[4,this.run((function(e){return r(d,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return e.application.getActivePage().applyTranslation(c.TranslatedText),[4,e.sync()];case 1:return t.sent(),[2]}}))}))}))];case 5:return p.sent(),[2,{sourceLanguage:e,targetLanguage:t,translationSize:c.TranslatedText.length}]}}))}))},e}();t.PageTranslator=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(529),o=function(){function e(e){this.translatorApi=e}return e.prototype.createFragmentTranslator=function(){return new r.FragmentTranslator(this.translatorApi)},e}();t.FragmentTranslatorFactory=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(530),a=function(){function e(e){this.translatorApi=e}return e.prototype.translateAsync=function(e,t,n,a,s){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return s.throwIfCancelled(),[4,this.translatorApi.translateNormalContent(n,a,{Data:e,DataType:i.toDataType(t)})];case 1:return r=o.sent(),s.throwIfCancelled(),[2,{contentType:t,translation:r.TranslatedText,sourceLanguage:r.DetectedSourceLanguage,targetLanguage:a,alignments:i.toTranslationAlignmentInfo(r.Alignments)}]}}))}))},e.prototype.isAugLoop=function(){return this.translatorApi.IsAugLoop()},e}();t.FragmentTranslator=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(104),o=n(69);t.toTranslationAlignmentInfo=function(e){return e?e.map((function(e){return{sourceTextStartIndex:e.SS,sourceTextEndIndex:e.SE,translatedTextStartIndex:e.TS,translatedTextEndIndex:e.TE}})):null},t.toDataType=function(e){switch(e){case r.ContentType.Text:return o.TranslationDataType.Text;case r.ContentType.Ooxml:return o.TranslationDataType.OoXml;case r.ContentType.Html:return o.TranslationDataType.Html;default:throw new Error(r.UnsupportedContentType)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(405),o=function(){function e(){this.current=null}return e.prototype.startNewSession=function(){return this.cancelCurrentSession(),this.current=new r.Session},e.prototype.cancelCurrentSession=function(){this.current&&this.current.cancel()},e}();t.SessionManager=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(117),i=r(n(6)),a=n(234),s=function(){function e(e,t,n,r,o,a,s,u){this.config=e,this.userConsent=t,this.service=n,this.host=r,this.contentTranslatorFactory=o,this.fragmentTranslatorFactory=a,this.contentSelectorFactory=s,this.sessionManager=u,i.default.Assert(e,"Invalid config!"),i.default.Assert(t,"Invalid userConsent!"),i.default.Assert(n,"Invalid service!"),i.default.Assert(r,"Invalid host!"),i.default.Assert(o,"Invalid contentTranslator!"),i.default.Assert(a,"Invalid fragmentTranslatorFactory!"),i.default.Assert(s,"Invalid contentSelectorFactory!"),i.default.Assert(u,"Invalid sessionManager!")}return e.prototype.GetOfficeHost=function(){return this.host},e.prototype.GetTranslatorApi=function(){return this.service},e.prototype.IsAugLoop=function(){return this.service.IsAugLoop()},e.prototype.ShouldShowUserConsent=function(){return this.userConsent.status!==a.UserConsentStatus.OptedIn},e.prototype.SaveUserConsent=function(){this.userConsent.status=a.UserConsentStatus.OptedIn},e.prototype.ShouldSupportFullContentTranslation=function(){var e=this.host.client.ShouldUseGoToTranslatedDocument();return!(this.host.platformType===o.PlatformType.OfficeOnline&&!e)&&(this.host.hostType===o.HostType.Word||this.host.hostType===o.HostType.OneNote)},e.prototype.ShouldShowSettingsTab=function(){return this.host.client.AreSettingsEnabled()},e}();t.Translator=s},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return L}));var r=n(43),o=n(224);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===l(i)?i:String(i)),r)}var o,i}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c,f,d=void 0!==e&&e.env?e.env.SERVICE_NAME:"client",p="abcdefghijklmnopqrstuvwxyz0123456789",h={97:0,98:1,99:2,100:3,101: