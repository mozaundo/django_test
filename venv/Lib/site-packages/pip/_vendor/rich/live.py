)(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=s(n(0)),c=n(110),f=n(52),d=n(817),p=n(393),h=n(392),g=n(9),m=n(4),v=s(n(351)),y=n(57),b=n(7),A=n(31),_=u(n(96)),T=u(n(18)),w=n(543),S=n(421),C=n(792),k=n(795),x=n(187),O=n(7),E=n(19);d.initializeIcons();var I=function(e){function t(t){var n=e.call(this,t)||this;return n.notifyOnSourceTargetSwap=x.debounce(n.notifyOnSourceTargetSwap.bind(n),O.DefaultThrottlingTimeMilliSeconds,{leading:!0}),n.state={sourceTargetSwapped:!1},n}return o(t,e),t.prototype.componentWillMount=function(){this.updateAriaPrefix(this.props)},t.prototype.componentWillReceiveProps=function(e){this.updateAriaPrefix(e)},t.prototype.render=function(){var e={text:this.props.sourceText,translationAlignments:this.props.translationAlignments,isSource:!0,highlightedAlignment:this.props.highlightedAlignment,hoverColor:this.props.theme.HoverColor,onMouseOver:this.props.onAlignmentMouseOver,onMouseOut:this.props.onAlignmentMouseOut,useTabNavigation:y.getOSType()!==y.OSType.Mac},t=this.props.sourceText.length<=b.InputLengthThresholdChars,n=this.props.currentSourceLanguage||this.props.detectedSourceLanguage,r=t||g.FontClassNames.xLarge===A.getVisibleFontSize(n),o=t||g.FontClassNames.xLarge===A.getVisibleFontSize(this.props.currentTargetLanguage),a=_.default.IsRtl()?"ts-float-left":"ts-float-right",s=this.props.hideInsertButton||0===this.props.sourceText.length,u=this.props.theme,c={rootHovered:{backgroundColor:(u.IsDarkTheme?u.InputBackgroundColor:"lightgray")+" !important"}};return l.createElement("div",{id:"Lookup",className:"ts-pivot-lookup-component"},l.createElement("div",{className:"ms-Grid ts-grid"},this.props.suggestionMessage?l.createElement("div",{className:"ms-Grid-row"},l.createElement(p.Link,{className:"ts-suggestion-link",onClick:this.props.onSuggestionClicked},this.props.suggestionMessage)):null,l.createElement("div",{className:"ms-Grid-row"},l.createElement(S.LookupSourceLanguageMenuComponent,{id:"lookupSourceLangMenu",onToggleSelect:this.onSourceToggleSelect})),l.createElement("div",{className:"ms-Grid-row"},l.createElement(C.TranslationTextFieldComponent,{placeholder:this.props.stringResources.inputTextFieldPlaceholderText,value:this.props.sourceText,language:this.props.currentSourceLanguage,isRtlContent:this.props.isSourceLanguageRtl,disableCopyCut:this.props.disableCopyCut,clearButtonTitle:this.props.stringResources.clearTextButtonTooltip,pronunciation:this.props.sourcePronunciation,showClearButton:!0,alignmentViewProps:e,highlightAlignmentText:this.props.highlightAlignmentText,textSelection:this.props.textSelection&&this.props.textSelection.isSource?this.props.textSelection:null,theme:this.props.theme,onTextChange:this.props.onSourceTextChange,onTextCleared:this.props.onSourceTextCleared,onTextSelected:this.props.onSourceTextSelected,isLargerFontSize:r})),l.createElement("div",{className:"ts-lookup-middle-container"},l.createElement("div",{className:"ts-lookup-switcher","aria-atomic":"true"},l.createElement(f.IconButton,{className:"ts-SwitcherButton-colorful ts-control-button",iconProps:{iconName:"SwitcherStartEnd"},ariaLabel:this.props.stringResources.reverseTranslationButtonTooltip,title:this.props.stringResources.reverseTranslationButtonTooltip,tabIndex:0,onClick:this.notifyOnSourceTargetSwap,onFocus:this.onFocus,onBlur:this.onBlur,styles:c})),l.createElement(h.Spinner,{label:"",className:"ts-lookup-spinner "+(this.props.showTextTranslationSpinner?"":"hidden")})),l.createElement("div",{className:"ms-Grid-row"},l.createElement(S.LookupTargetLanguageMenuComponent,{id:"lookupTargetLangMenu",onToggleSelect:this.onTargetToggleSelect})),l.createElement("div",{className:"ms-Grid-row"},l.createElement(C.TranslationTextFieldComponent,{placeholder:"",value:this.props.targetText,language:this.props.currentTargetLanguage,ariaPrefix:this.translationTargetAriaPrefix,isRtlContent:this.props.isTargetLanguageRtl,disableCopyCut:this.props.disableCopyCut,pronunciation:this.props.targetPronunciation,showCopyButton:!0,alignmentViewProps:i(i({},e),{isSource:!1}),highlightAlignmentText:this.props.highlightAlignmentText,textSelection:this.props.textSelection&&!this.props.textSelection.isSource?this.props.textSelection:null,theme:this.props.theme,onTextSelected:this.props.onTargetTextSelected,isLargerFontSize:o})),l.createElement("div",{className:"ms-Grid-row"},l.createElement("div",{className:"ts-insert-button-container"},s?null:l.createElement(k.InsertButtonContainer,{className:a+" ts-margin-top-10px ts-insert-focus ts-text-insert-button ts-button ts-button-colorful",onClick:this.props.onInsertTranslation,title:this.props.stringResources.insertTranslationButtonTooltip,disabled:this.props.disableInsertButton,insertTranslationButtonLabel:this.props.stringResources.insertTranslationButtonLabel,ariaLiveMessage:this.props.stringResources.audioMessageInsertTranslationAnnounce}))),l.createElement("div",{className:"ms-Grid-row"},l.createElement(w.AlternateTranslationsComponent,{lookupText:this.props.highlightedText,alternateTranslationModel:this.props.altTranslationModel,collapsed:this.props.alternateTranslationsCollapsed,onCollapseStateChanged:this.props.onAlternateTranslationsStateChanged,headerLabel:this.props.stringResources.alternativeTranslationsSectionTitle,stringResources:this.props.stringResources,theme:this.props.theme,onCopy:this.props.onAlternateTranslationCopyClicked,onShowMore:this.props.onAlternateTranslationShowExampleClicked})),l.createElement("div",{className:"ms-Grid-row ts-page-end-padding"})))},t.prototype.onFocus=function(e){$(".ts-SwitcherButton-colorful").attr("aria-live","assertive"),this.setState({sourceTargetSwapped:!1})},t.prototype.onBlur=function(e){$(".ts-SwitcherButton-colorful").attr("aria-live","off"),this.setState({sourceTargetSwapped:!1})},t.prototype.onSourceToggleSelect=function(e){this.props.onSourceToggleSelect(e.LanguageTag)},t.prototype.onTargetToggleSelect=function(e){this.props.onTargetToggleSelect(e.LanguageTag)},t.prototype.updateAriaPrefix=function(e){var t=e.currentTargetLanguage&&e.targetLanguages?e.targetLanguages.filter((function(t,n,r){return t.LanguageTag===e.currentTargetLanguage})):null,n=t&&t.length>0?t[0].LanguageName:null;n&&(this.translationTargetAriaPrefix=T.default.StringFormat(this.props.stringResources.translationTargetFormatAriaText,n))},t.prototype.notifyOnSourceTargetSwap=function(){T.default.CreateAriaLiveElement(this.props.stringResources.reverseTranslationButtonOnClickText),this.setState({sourceTargetSwapped:!0}),this.props.onSourceTargetSwap&&this.props.onSourceTargetSwap()},a([m.autobind],t.prototype,"onFocus",null),a([m.autobind],t.prototype,"onBlur",null),a([m.autobind],t.prototype,"onSourceToggleSelect",null),a([m.autobind],t.prototype,"onTargetToggleSelect",null),a([m.autobind],t.prototype,"updateAriaPrefix",null),t}(l.Component);t.default=c.connect((function(e){return i(i(i({},e.lookupModel),e.viewStatus),e.viewSettings)}),(function(e){return{onInsertTranslation:function(){E.dispatchWithId(e)(v.insertTranslation())},onSourceTargetSwap:function(){E.dispatchWithId(e)(v.sourceTargetSwap())},onSourceTextChange:function(t,n){E.dispatchWithId(e)(v.sourceTextChanged(t,n))},onSourceTextSelected:function(t,n,r){E.dispatchWithId(e)(v.sourceTextSelected(t,n,r))},onSourceTextCleared:function(){E.dispatchWithId(e)(v.sourceTextReset())},onSourceToggleSelect:function(t){E.dispatchWithId(e)(v.sourceTextLanguageChanged(t))},onTargetToggleSelect:function(t){E.dispatchWithId(e)(v.targetTextLanguageChanged(t))},onTargetTextSelected:function(t,n,r){E.dispatchWithId(e)(v.targetTextSelected(t,n,r))},onAlignmentMouseOver:function(t,n){E.dispatchWithId(e)(v.alignmentMouseOver(t,n))},onAlignmentMouseOut:function(){E.dispatchWithId(e)(v.alignmentMouseOut())},onAlternateTranslationsStateChanged:function(t){E.dispatchWithId(e)(v.alternateTranslationsCollapsedStateChanged(t))},onAlternateTranslationCopyClicked:function(t,n){E.dispatchWithId(e)(v.alternateTranslationsCopyClicked(t,n))},onAlternateTranslationShowExampleClicked:function(t,n){E.dispatchWithId(e)(v.alternateTranslationsShowExampleClicked(t,n))},onSuggestionClicked:function(){E.dispatchWithId(e)(v.docTranslationSuggestionClicked())}}}))(I)},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),u=n(78),l=n(824),c=n(4),f=n(544),d=n(545),p=a(n(35)),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.posTitleMap=null,t}return o(t,e),t.prototype.createLocalizedPosStrings=function(e){var t;this.posTitleMap=((t={}).adjective=e.stringResources.altTranslationsGroupTitleAdjective,t.adj=e.stringResources.altTranslationsGroupTitleAdjective,t.adverb=e.stringResources.altTranslationsGroupTitleAdverb,t.adv=e.stringResources.altTranslationsGroupTitleAdverb,t.conjunction=e.stringResources.altTranslationsGroupTitleConjunction,t.conj=e.stringResources.altTranslationsGroupTitleConjunction,t.determiner=e.stringResources.altTranslationsGroupTitleDeterminer,t.det=e.stringResources.altTranslationsGroupTitleDeterminer,t.noun=e.stringResources.altTranslationsGroupTitleNoun,t.preposition=e.stringResources.altTranslationsGroupTitlePreposition,t.prep=e.stringResources.altTranslationsGroupTitlePreposition,t.pronoun=e.stringResources.altTranslationsGroupTitlePronoun,t.pron=e.stringResources.altTranslationsGroupTitlePronoun,t.verb=e.stringResources.altTranslationsGroupTitleVerb,t)},t.prototype.componentWillReceiveProps=function(e){this.createLocalizedPosStrings(e)},t.prototype.render=function(){var e=this;if(!p.default.GetParameter(p.FlightName.AltTranslationsDefinitions))return null;if(!this.props.collapsed&&(!this.props.lookupText||!this.props.alternateTranslationModel||!this.props.alternateTranslationModel.TranslationGroups||this.props.alternateTranslationModel.TranslationGroups.length<=0))return null;if(this.props.collapsed&&!this.props.lookupText)return null;this.posTitleMap||this.createLocalizedPosStrings(this.props);var t=this.props.alternateTranslationModel&&this.props.alternateTranslationModel.TranslationGroups;return s.createElement(d.CollapsibleComponent,{theme:this.props.theme,titleData:{format:this.props.headerLabel||"{0}",data:this.props.lookupText},collapsed:this.props.collapsed,onCollapseStateChanged:this.props.onCollapseStateChanged},s.createElement("div",{className:"ts-alternate-translations"},t?t.map((function(t,n){var r=t?t.Translations:null,o=e.posTitleMap[t.Pos]||t.Pos;return!r||r.length<=0?null:s.createElement("div",{className:"ts-alternate-translations-group",key:"alternate-translations-group_"+t.Pos+"_"+n},s.createElement(u.Label,{className:"ts-alternate-translations-pos ts-no-padding",tabIndex:0,"aria-label":o},o),s.createElement(l.List,{componentRef:function(e){return e&&e.forceUpdate()},className:"ts-alternate-translations-list",items:r,onRenderCell:function(t,r){var o=t?t.BackTranslations:null,i={id:(new Date).getTime()+r+n,groupIndex:n,translationIndex:r},a={NormalizedText:t.NormalizedTarget,DisplayText:t.DisplayTarget};return o?s.createElement(f.AlternateTranslationItemComponent,{uniqueId:i,keyId:"alternate-translations-item_"+n+"_"+r,translatedTextData:a,backTranslations:o,example:t.Example,stringResources:e.props.stringResources,theme:e.props.theme,onTranslatedTextClicked:e.props.onTranslatedTextClicked,onBackTranslationClicked:e.props.onBackTranslationClicked,onCopy:e.onCopyAction,onShowMore:e.onShowMoreAction}):null}}))})):null))},t.prototype.onTranslatedTextClickAction=function(e,t){this.props.onTranslatedTextClicked&&e&&this.props.onTranslatedTextClicked(e,t)},t.prototype.onBackTranslationClickAction=function(e,t){this.props.onBackTranslationClicked&&e&&this.props.onBackTranslationClicked(e,t)},t.prototype.onCopyAction=function(e,t){this.props.onCopy&&e&&this.props.onCopy(e,t)},t.prototype.onShowMoreAction=function(e,t){this.props.onShowMore&&e&&this.props.onShowMore(e,t)},i([c.autobind],t.prototype,"createLocalizedPosStrings",null),i([c.autobind],t.prototype,"onTranslatedTextClickAction",null),i([c.autobind],t.prototype,"onBackTranslationClickAction",null),i([c.autobind],t.prototype,"onCopyAction",null),i([c.autobind],t.prototype,"onShowMoreAction",null),t}(s.Component);t.AlternateTranslationsComponent=h},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Arra